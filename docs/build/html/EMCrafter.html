

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>EMCrafter package &mdash; EMCrafter 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="EMCrafter documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">EMCrafter package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.base">EMCrafter.base</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.base.Base"><code class="docutils literal notranslate"><span class="pre">Base</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.base.Base.load"><code class="docutils literal notranslate"><span class="pre">Base.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.base.Base.logger"><code class="docutils literal notranslate"><span class="pre">Base.logger</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.base.Base.save"><code class="docutils literal notranslate"><span class="pre">Base.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.sampler">EMCrafter.sampler</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler"><code class="docutils literal notranslate"><span class="pre">DefocusSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.build_sampler"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.build_sampler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.get_histo"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.get_histo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.load"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.load()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.read_defocus"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.read_defocus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.sample"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.set_arr"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.set_arr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler.validate"><code class="docutils literal notranslate"><span class="pre">DefocusSampler.validate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.sampler.OrientationSampler"><code class="docutils literal notranslate"><span class="pre">OrientationSampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.OrientationSampler.plot"><code class="docutils literal notranslate"><span class="pre">OrientationSampler.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.OrientationSampler.reset_vars"><code class="docutils literal notranslate"><span class="pre">OrientationSampler.reset_vars()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.OrientationSampler.sample"><code class="docutils literal notranslate"><span class="pre">OrientationSampler.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.OrientationSampler.sample_clusters"><code class="docutils literal notranslate"><span class="pre">OrientationSampler.sample_clusters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.OrientationSampler.set_lengths"><code class="docutils literal notranslate"><span class="pre">OrientationSampler.set_lengths()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.sampler.Sampler"><code class="docutils literal notranslate"><span class="pre">Sampler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.Sampler.sample"><code class="docutils literal notranslate"><span class="pre">Sampler.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sampler.Sampler.set_seed"><code class="docutils literal notranslate"><span class="pre">Sampler.set_seed()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.snr">EMCrafter.snr</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.snr.SNR"><code class="docutils literal notranslate"><span class="pre">SNR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.snr.SNR.empty"><code class="docutils literal notranslate"><span class="pre">SNR.empty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.snr.SNR.plot"><code class="docutils literal notranslate"><span class="pre">SNR.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.snr.SNR.set_flat"><code class="docutils literal notranslate"><span class="pre">SNR.set_flat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.snr.SNR.set_histo"><code class="docutils literal notranslate"><span class="pre">SNR.set_histo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.snr.SNR.set_value_func"><code class="docutils literal notranslate"><span class="pre">SNR.set_value_func()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.noise">EMCrafter.noise</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.NoiseFit"><code class="docutils literal notranslate"><span class="pre">NoiseFit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.chi2"><code class="docutils literal notranslate"><span class="pre">NoiseFit.chi2()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.data"><code class="docutils literal notranslate"><span class="pre">NoiseFit.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.fit"><code class="docutils literal notranslate"><span class="pre">NoiseFit.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.get_noise_distribution"><code class="docutils literal notranslate"><span class="pre">NoiseFit.get_noise_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.images"><code class="docutils literal notranslate"><span class="pre">NoiseFit.images</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.load_images"><code class="docutils literal notranslate"><span class="pre">NoiseFit.load_images()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.plot_fit"><code class="docutils literal notranslate"><span class="pre">NoiseFit.plot_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.plot_noise_distribution"><code class="docutils literal notranslate"><span class="pre">NoiseFit.plot_noise_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.read_particles"><code class="docutils literal notranslate"><span class="pre">NoiseFit.read_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseFit.red_chi2"><code class="docutils literal notranslate"><span class="pre">NoiseFit.red_chi2()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.NoiseGenerator"><code class="docutils literal notranslate"><span class="pre">NoiseGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseGenerator.load_modulator"><code class="docutils literal notranslate"><span class="pre">NoiseGenerator.load_modulator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseGenerator.load_shaper"><code class="docutils literal notranslate"><span class="pre">NoiseGenerator.load_shaper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseGenerator.plot"><code class="docutils literal notranslate"><span class="pre">NoiseGenerator.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseGenerator.simulate"><code class="docutils literal notranslate"><span class="pre">NoiseGenerator.simulate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator"><code class="docutils literal notranslate"><span class="pre">NoiseModulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.expand_radial_profile"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.expand_radial_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.fft"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.fft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.ifft"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.ifft()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.magnitude"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.magnitude()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.modulate"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.modulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.plot_modulated"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.plot_modulated()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.plot_modulator_1D"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.plot_modulator_1D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.plot_modulator_2D"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.plot_modulator_2D()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.power"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.power()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.radial_profile"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.radial_profile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.set_apix"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.set_apix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.set_flat"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.set_flat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseModulator.set_modulation"><code class="docutils literal notranslate"><span class="pre">NoiseModulator.set_modulation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper"><code class="docutils literal notranslate"><span class="pre">NoiseShaper</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.build_sampler"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.build_sampler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.get_index"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.get_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.plot_density"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.plot_density()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.plot_image"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.plot_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.sample"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.set_exp_mod_gaussian_shape"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.set_exp_mod_gaussian_shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.set_gaussian_shape"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.set_gaussian_shape()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.noise.NoiseShaper.set_skew_normal_shape"><code class="docutils literal notranslate"><span class="pre">NoiseShaper.set_skew_normal_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.exp_mod_gaussian"><code class="docutils literal notranslate"><span class="pre">exp_mod_gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.gaussian"><code class="docutils literal notranslate"><span class="pre">gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.noise.skew_normal"><code class="docutils literal notranslate"><span class="pre">skew_normal()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.signal">EMCrafter.signal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator"><code class="docutils literal notranslate"><span class="pre">SignalGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.corrupt_n_particles"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.corrupt_n_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.corrupt_signal"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.corrupt_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.density_projections_core"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.density_projections_core()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.em2np"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.em2np()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.get_error"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.get_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.load_volume"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.load_volume()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.make_mask"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.make_mask()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.merge_single_files"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.merge_single_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.normalize_signal"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.normalize_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.np2em"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.np2em()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.pdb2map"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.pdb2map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.plot"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.project_signal"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.project_signal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_cpus"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_cpus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_eman_dir"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_eman_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_env"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_force"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_force()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_output"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_output()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_parameters"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.set_pdb"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.set_pdb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.simulate"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.simulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.simulate_n"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.simulate_n()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.simulate_n_projections"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.simulate_n_projections()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.simulate_single_eman"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.simulate_single_eman()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.validate_files"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.validate_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.validate_init"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.validate_init()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.signal.SignalGenerator.validate_output"><code class="docutils literal notranslate"><span class="pre">SignalGenerator.validate_output()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.sim">EMCrafter.sim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.info"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.info()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.load_modulator"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.load_modulator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.load_shaper"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.load_shaper()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.normalize"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.set_cpus"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.set_cpus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.simulate"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.simulate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.ParticleSimulator.simulate_dataset"><code class="docutils literal notranslate"><span class="pre">ParticleSimulator.simulate_dataset()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.sim.SimResults"><code class="docutils literal notranslate"><span class="pre">SimResults</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.append"><code class="docutils literal notranslate"><span class="pre">SimResults.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.append_array"><code class="docutils literal notranslate"><span class="pre">SimResults.append_array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.export_particles"><code class="docutils literal notranslate"><span class="pre">SimResults.export_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.merge"><code class="docutils literal notranslate"><span class="pre">SimResults.merge()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.plot"><code class="docutils literal notranslate"><span class="pre">SimResults.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.set_box_size"><code class="docutils literal notranslate"><span class="pre">SimResults.set_box_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.set_parameters"><code class="docutils literal notranslate"><span class="pre">SimResults.set_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.set_particle_number"><code class="docutils literal notranslate"><span class="pre">SimResults.set_particle_number()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.set_plot_ids"><code class="docutils literal notranslate"><span class="pre">SimResults.set_plot_ids()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.set_random_ids"><code class="docutils literal notranslate"><span class="pre">SimResults.set_random_ids()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.sim.SimResults.set_type"><code class="docutils literal notranslate"><span class="pre">SimResults.set_type()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.rln">EMCrafter.rln</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.rln.Exporter"><code class="docutils literal notranslate"><span class="pre">Exporter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.build_output"><code class="docutils literal notranslate"><span class="pre">Exporter.build_output()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.build_particles"><code class="docutils literal notranslate"><span class="pre">Exporter.build_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.copy"><code class="docutils literal notranslate"><span class="pre">Exporter.copy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.create_fake_micrograph"><code class="docutils literal notranslate"><span class="pre">Exporter.create_fake_micrograph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.export"><code class="docutils literal notranslate"><span class="pre">Exporter.export()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.format_optics"><code class="docutils literal notranslate"><span class="pre">Exporter.format_optics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.format_particles"><code class="docutils literal notranslate"><span class="pre">Exporter.format_particles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.set_output_dir"><code class="docutils literal notranslate"><span class="pre">Exporter.set_output_dir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.set_particles_attributes"><code class="docutils literal notranslate"><span class="pre">Exporter.set_particles_attributes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.validate_export"><code class="docutils literal notranslate"><span class="pre">Exporter.validate_export()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.Exporter.write"><code class="docutils literal notranslate"><span class="pre">Exporter.write()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.rln.rlnParticles"><code class="docutils literal notranslate"><span class="pre">rlnParticles</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.rlnParticles.get"><code class="docutils literal notranslate"><span class="pre">rlnParticles.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.rlnParticles.load_images"><code class="docutils literal notranslate"><span class="pre">rlnParticles.load_images()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.rlnParticles.read"><code class="docutils literal notranslate"><span class="pre">rlnParticles.read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.rlnParticles.set_base_folder"><code class="docutils literal notranslate"><span class="pre">rlnParticles.set_base_folder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.rlnParticles.set_data"><code class="docutils literal notranslate"><span class="pre">rlnParticles.set_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#EMCrafter.rln.rlnParticles.write"><code class="docutils literal notranslate"><span class="pre">rlnParticles.write()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-EMCrafter.utils">EMCrafter.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.utils.circular_mask"><code class="docutils literal notranslate"><span class="pre">circular_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#EMCrafter.utils.time_format"><code class="docutils literal notranslate"><span class="pre">time_format()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EMCrafter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">EMCrafter package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/EMCrafter.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="emcrafter-package">
<h1>EMCrafter package<a class="headerlink" href="#emcrafter-package" title="Link to this heading"></a></h1>
<section id="module-EMCrafter.base">
<span id="emcrafter-base"></span><h2>EMCrafter.base<a class="headerlink" href="#module-EMCrafter.base" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.base.Base">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.base.</span></span><span class="sig-name descname"><span class="pre">Base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/base.html#Base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.base.Base" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.base.Base.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/base.html#Base.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.base.Base.load" title="Link to this definition"></a></dt>
<dd><p>Loads a saved object from a file using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – The file path from which the object’s state was saved.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The loaded object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="EMCrafter.base.Base.logger">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#EMCrafter.base.Base.logger" title="Link to this definition"></a></dt>
<dd><p>A logger object with the name of the class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A logger object with the name of the class.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>logging.Logger</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.base.Base.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/base.html#Base.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.base.Base.save" title="Link to this definition"></a></dt>
<dd><p>Save the current state of the object to a file using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – The file path where the object’s state will be saved.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EMCrafter.sampler">
<span id="emcrafter-sampler"></span><h2>EMCrafter.sampler<a class="headerlink" href="#module-EMCrafter.sampler" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.sampler.</span></span><span class="sig-name descname"><span class="pre">DefocusSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.sampler.Sampler" title="EMCrafter.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.build_sampler">
<span class="sig-name descname"><span class="pre">build_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.build_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.build_sampler" title="Link to this definition"></a></dt>
<dd><p>Builds a sampler from the given array of defocus values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> (<em>array</em>) – An array of defocus values</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of bins to use when computing the histogram</p></li>
<li><p><strong>validate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plots the histogram of the defocus distribution</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.get_histo">
<span class="sig-name descname"><span class="pre">get_histo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.get_histo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.get_histo" title="Link to this definition"></a></dt>
<dd><p>Compute the histogram of the input values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vals</strong> (<em>array_like</em>) – Input values</p></li>
<li><p><strong>n_bins</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bins (default is 100)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Bin centers</p></li>
<li><p><strong>y</strong> (<em>array</em>) – Normalized histogram values</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.load" title="Link to this definition"></a></dt>
<dd><p>Loads a saved DefocusSampler object from a file using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – The file path from which the DefocusSampler object will be loaded.</p></li>
<li><p><strong>validate</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, validate the loaded sampler against the original data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – The loaded DefocusSampler object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#EMCrafter.sampler.DefocusSampler" title="EMCrafter.sampler.DefocusSampler">DefocusSampler</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.read_defocus">
<span class="sig-name descname"><span class="pre">read_defocus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.read_defocus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.read_defocus" title="Link to this definition"></a></dt>
<dd><p>Reads defocus values from a STAR file and sets the defocus array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – The path to the STAR file containing defocus values.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of average defocus values computed as the mean of ‘rlnDefocusU’ and ‘rlnDefocusV’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.sample" title="Link to this definition"></a></dt>
<dd><p>Samples random defocus values based on the histogram distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random defocus values to sample. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of sampled defocus values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.set_arr">
<span class="sig-name descname"><span class="pre">set_arr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.set_arr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.set_arr" title="Link to this definition"></a></dt>
<dd><p>Sets the defocus array, given as an input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arr</strong> (<em>array</em>) – An array of defocus values</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the provided array is empty or None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.DefocusSampler.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#DefocusSampler.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.DefocusSampler.validate" title="Link to this definition"></a></dt>
<dd><p>Validates the sampler by comparing the histogram of sampled defocus values
with the expected distribution. This function is only used for testing
purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – The x-coordinates of the histogram</p></li>
<li><p><strong>y</strong> (<em>array</em>) – The y-coordinates of the histogram</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.sampler.OrientationSampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.sampler.</span></span><span class="sig-name descname"><span class="pre">OrientationSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#OrientationSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.OrientationSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.sampler.Sampler" title="EMCrafter.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.OrientationSampler.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[360,</span> <span class="pre">360,</span> <span class="pre">360]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#OrientationSampler.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.OrientationSampler.plot" title="Link to this definition"></a></dt>
<dd><p>Plots the Euler angles stored in the OrientationSampler instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limits</strong> (<em>list</em><em> of </em><em>3 ints</em><em>, </em><em>optional</em>) – The limits for each of the 3 Euler angle dimensions. Defaults to [360, 360, 360].</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show the plot. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.OrientationSampler.reset_vars">
<span class="sig-name descname"><span class="pre">reset_vars</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#OrientationSampler.reset_vars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.OrientationSampler.reset_vars" title="Link to this definition"></a></dt>
<dd><p>Resets the OrientationSampler instance variables to their initial state.</p>
<p>This includes clearing the lists of angles and clusters, and resetting the counters for
the number of angles and clusters to 0.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.OrientationSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(360,</span> <span class="pre">360,</span> <span class="pre">360)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#OrientationSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.OrientationSampler.sample" title="Link to this definition"></a></dt>
<dd><p>Generates n random Euler angles between 0 and the specified limits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – The number of random angles to generate.</p></li>
<li><p><strong>limits</strong> (<em>tuple</em><em> of </em><em>3 ints</em><em>, </em><em>optional</em>) – The limits for each of the 3 Euler angle dimensions. Defaults to (360, 360, 360).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self.angles</strong> – The generated array of random Euler angles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.OrientationSampler.sample_clusters">
<span class="sig-name descname"><span class="pre">sample_clusters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(360,</span> <span class="pre">360,</span> <span class="pre">360)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#OrientationSampler.sample_clusters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.OrientationSampler.sample_clusters" title="Link to this definition"></a></dt>
<dd><p>Generates clusters of Euler angles with specified properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of random angles to generate per cluster. Defaults to 10.</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of clusters of angles to generate. Defaults to 1.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – The standard deviation for the Gaussian distribution used to generate angles around
each cluster center. Defaults to 5.</p></li>
<li><p><strong>limits</strong> (<em>tuple</em><em> of </em><em>3 ints</em><em>, </em><em>optional</em>) – The limits for each of the 3 Euler angle dimensions. Defaults to (360, 360, 360).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>self.angles</strong> (<em>np.ndarray</em>) – The generated array of random Euler angles.</p></li>
<li><p><strong>self.clusters</strong> (<em>np.ndarray</em>) – The array of cluster centers.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.OrientationSampler.set_lengths">
<span class="sig-name descname"><span class="pre">set_lengths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#OrientationSampler.set_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.OrientationSampler.set_lengths" title="Link to this definition"></a></dt>
<dd><p>Updates the counters for the number of angles and clusters in the OrientationSampler instance.</p>
<p>This method should be called after modifying the lists of angles or clusters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.sampler.Sampler">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.sampler.</span></span><span class="sig-name descname"><span class="pre">Sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#Sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.Sampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.Sampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#Sampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.Sampler.sample" title="Link to this definition"></a></dt>
<dd><p>Draw a sample. Must be implemented by subclass.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sampler.Sampler.set_seed">
<span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sampler.html#Sampler.set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sampler.Sampler.set_seed" title="Link to this definition"></a></dt>
<dd><p>Set the local seed for the random number generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for the random number generator. Defaults to None.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EMCrafter.snr">
<span id="emcrafter-snr"></span><h2>EMCrafter.snr<a class="headerlink" href="#module-EMCrafter.snr" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.snr.SNR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.snr.</span></span><span class="sig-name descname"><span class="pre">SNR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/snr.html#SNR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.snr.SNR" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.snr.SNR.empty">
<span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/snr.html#SNR.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.snr.SNR.empty" title="Link to this definition"></a></dt>
<dd><p>Empty the SNR object.</p>
<p>Sets all variables to None and removes any assigned distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.snr.SNR.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/snr.html#SNR.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.snr.SNR.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the SNR distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, shows the plot. Default is True.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib axes</em><em>, </em><em>optional</em>) – Axes to plot on. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.snr.SNR.set_flat">
<span class="sig-name descname"><span class="pre">set_flat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/snr.html#SNR.set_flat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.snr.SNR.set_flat" title="Link to this definition"></a></dt>
<dd><p>Set a flat SNR distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>snr</strong> (<em>float</em>) – Value of the SNR for the flat distribution. Default is 0.05.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.snr.SNR.set_histo">
<span class="sig-name descname"><span class="pre">set_histo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">defocus_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'um'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">emp_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/snr.html#SNR.set_histo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.snr.SNR.set_histo" title="Link to this definition"></a></dt>
<dd><p>Set the SNR as a histogram from a given array of defocus bin edges and SNR values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>defocus_edges</strong> (<em>array</em>) – The bin edges of the histogram in microns or Angstroms.</p></li>
<li><p><strong>snr</strong> (<em>array</em>) – The SNR values corresponding to the bin edges.</p></li>
<li><p><strong>unit</strong> (<em>str</em><em>, </em><em>optional</em>) – The unit of the defocus bin edges. Default is “um”.</p></li>
<li><p><strong>emp_factor</strong> (<em>float</em><em>, </em><em>optional</em>) – The empirical factor to apply to the SNR values. Default is 2.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.snr.SNR.set_value_func">
<span class="sig-name descname"><span class="pre">set_value_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interpolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/snr.html#SNR.set_value_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.snr.SNR.set_value_func" title="Link to this definition"></a></dt>
<dd><p>Set the SNR value function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>callable</em>) – The function to use to calculate the SNR value.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EMCrafter.noise">
<span id="emcrafter-noise"></span><h2>EMCrafter.noise<a class="headerlink" href="#module-EMCrafter.noise" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">NoiseFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.chi2">
<span class="sig-name descname"><span class="pre">chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yh</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.chi2" title="Link to this definition"></a></dt>
<dd><p>Calculate chi-squared between the data and a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array</em>) – The data</p></li>
<li><p><strong>yerr</strong> (<em>array</em>) – The error bars on the data</p></li>
<li><p><strong>yh</strong> (<em>array</em>) – The model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>chi_squared</strong> – The chi-squared between the data and the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.data">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">data</span></span><a class="headerlink" href="#EMCrafter.noise.NoiseFit.data" title="Link to this definition"></a></dt>
<dd><p>The data stored in the associated STAR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The data stored in the associated STAR file, or None if no file is associated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.fit" title="Link to this definition"></a></dt>
<dd><p>Fit the noise distribution to a given probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf</strong> (<em>str</em>) – The type of probability density function to fit. Must be one of the following:
- gaussian
- skew_normal
- exp_mod_gaussian</p></li>
<li><p><strong>p0</strong> (<em>array</em>) – The initial parameters for the fit</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.get_noise_distribution">
<span class="sig-name descname"><span class="pre">get_noise_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(-8,</span> <span class="pre">6)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.get_noise_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.get_noise_distribution" title="Link to this definition"></a></dt>
<dd><p>Compute the noise distribution from the particle images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – A boolean mask with the same shape as the images.
If None, all pixels are used. Defaults to None.</p></li>
<li><p><strong>irange</strong> (<em>tuple</em><em>, </em><em>optional</em>) – The range of values to include in the histogram.
Defaults to (-8, 6).</p></li>
<li><p><strong>nbins</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of bins to use in the histogram.
Defaults to 100.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.images">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">images</span></span><a class="headerlink" href="#EMCrafter.noise.NoiseFit.images" title="Link to this definition"></a></dt>
<dd><p>The particle images stored in the associated STAR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The particle images stored in the associated STAR file, or None if no file is associated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.load_images">
<span class="sig-name descname"><span class="pre">load_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.load_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.load_images" title="Link to this definition"></a></dt>
<dd><p>Load the particle images from the STAR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<em>str</em>) – The base folder containing the particle images.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of images to load. If None, all images are loaded.
Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.plot_fit">
<span class="sig-name descname"><span class="pre">plot_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.plot_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.plot_fit" title="Link to this definition"></a></dt>
<dd><p>Plot the noise distribution and a fit to it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dmin</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum data value that the y-axis covers. Defaults to 1e-10.</p></li>
<li><p><strong>dmax</strong> (<em>float</em><em>, </em><em>optional</em>) – The maximum data value that the y-axis covers. Defaults to 0.8.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The matplotlib figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.plot_noise_distribution">
<span class="sig-name descname"><span class="pre">plot_noise_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.plot_noise_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.plot_noise_distribution" title="Link to this definition"></a></dt>
<dd><p>Plot the noise distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dmin</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum data value that the y-axis covers. Defaults to 1e-10.</p></li>
<li><p><strong>dmax</strong> (<em>float</em><em>, </em><em>optional</em>) – The maximum data value that the y-axis covers. Defaults to 0.8.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The matplotlib figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.read_particles">
<span class="sig-name descname"><span class="pre">read_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.read_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.read_particles" title="Link to this definition"></a></dt>
<dd><p>Read a STAR file and select particles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – The path to the STAR file containing the particle data.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of particles to select.
If None, all particles are selected. Defaults to None.</p></li>
<li><p><strong>ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – The indices of the particles to select.
If None, all particles are selected. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseFit.red_chi2">
<span class="sig-name descname"><span class="pre">red_chi2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseFit.red_chi2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseFit.red_chi2" title="Link to this definition"></a></dt>
<dd><p>Calculate the reduced chi-squared between the data and a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array</em>) – The data</p></li>
<li><p><strong>yerr</strong> (<em>array</em>) – The error bars on the data</p></li>
<li><p><strong>yh</strong> (<em>array</em>) – The model</p></li>
<li><p><strong>nparams</strong> (<em>int</em>) – The number of parameters in the model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>red_chi2</strong> – The reduced chi-squared between the data and the model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseGenerator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">NoiseGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseGenerator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseGenerator.load_modulator">
<span class="sig-name descname"><span class="pre">load_modulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noise_freq.pkl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseGenerator.load_modulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseGenerator.load_modulator" title="Link to this definition"></a></dt>
<dd><p>Loads a saved NoiseModulator object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>optional</em>) – The file path from which the NoiseModulator object is to be loaded. Defaults to “noise_freq.pkl”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseGenerator.load_shaper">
<span class="sig-name descname"><span class="pre">load_shaper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noise_shape.pkl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseGenerator.load_shaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseGenerator.load_shaper" title="Link to this definition"></a></dt>
<dd><p>Loads a saved NoiseShaper object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>optional</em>) – The file path from which the NoiseShaper object is to be loaded. Defaults to “noise_shape.pkl”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseGenerator.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_fft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseGenerator.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseGenerator.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the generated noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmap_img</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap for the spatial-domain image. Defaults to “gray”.</p></li>
<li><p><strong>cmap_fft</strong> (<em>str</em><em>, </em><em>optional</em>) – Colormap for the frequency-domain image. Defaults to “hot”.</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – Minimum data value that the colormap covers. Defaults to None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum data value that the colormap covers. Defaults to None.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseGenerator.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseGenerator.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseGenerator.simulate" title="Link to this definition"></a></dt>
<dd><p>Simulate a set of noisy images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – Shape of the output image(s).</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of images to generate. Defaults to 1.</p></li>
<li><p><strong>store</strong> (<em>bool</em><em>, </em><em>optional</em>) – Store the generated noise in the <cite>white</cite> attribute of the NoiseShaper object.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>colored</strong> – The colored noise image(s) with the same shape as the input <cite>shape</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">NoiseModulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.expand_radial_profile">
<span class="sig-name descname"><span class="pre">expand_radial_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_profile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.expand_radial_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.expand_radial_profile" title="Link to this definition"></a></dt>
<dd><p>Expand a 1D radial profile into a 2D array using given bin edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bin_edges</strong> (<em>array</em>) – The edges of the bins in the radial direction.</p></li>
<li><p><strong>radial_profile</strong> (<em>array</em>) – The 1D profile values corresponding to the bin edges.</p></li>
<li><p><strong>shape</strong> (<em>tuple</em>) – The shape of the 2D array to expand into (height, width).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>expanded</strong> – A 2D array where each pixel value is determined by the radial profile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.fft">
<span class="sig-name descname"><span class="pre">fft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.fft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.fft" title="Link to this definition"></a></dt>
<dd><p>Compute the 2D Fourier transform of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>array</em>) – The image to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fft</strong> – The 2D Fourier transform of the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.ifft">
<span class="sig-name descname"><span class="pre">ifft</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.ifft"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.ifft" title="Link to this definition"></a></dt>
<dd><p>Compute the inverse 2D Fourier transform of an image.</p>
<p>This function takes a frequency-domain representation of an image,
shifts the zero-frequency component back to the corners of the spectrum,
performs an inverse 2D Fourier transform, and returns the real part of
the transformed image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>array</em>) – The frequency-domain representation of the image.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The spatial-domain representation of the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.magnitude">
<span class="sig-name descname"><span class="pre">magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.magnitude" title="Link to this definition"></a></dt>
<dd><p>Compute the magnitude of the 2D Fourier transform of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>array</em>) – The image to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>magnitude</strong> – The magnitude of the 2D Fourier transform of the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.modulate">
<span class="sig-name descname"><span class="pre">modulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.modulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.modulate" title="Link to this definition"></a></dt>
<dd><p>Modulate an input image using a predefined noise profile.</p>
<p>This function takes an input image, performs a Fourier transform, and applies
amplitude modulation to the frequency components using a predefined noise profile.
The result is an image where the noise characteristics have been altered according
to the specified modulation profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>ndarray</em>) – The input image to be modulated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The modulated image with adjusted noise characteristics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.plot_modulated">
<span class="sig-name descname"><span class="pre">plot_modulated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">noise_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_img</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_fft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.plot_modulated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.plot_modulated" title="Link to this definition"></a></dt>
<dd><p>Plots the original white noise, modulated noise, and their magnitude difference.</p>
<p>This function visualizes the effects of noise modulation by displaying three
images side by side: the original white noise image, the modulated noise image,
and the difference in magnitude between the two in the Fourier domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise_type</strong> (<em>str</em><em>, </em><em>optional</em>) – A label for the type of noise being visualized. Defaults to an empty string.</p></li>
<li><p><strong>cmap_img</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for the image plots. Defaults to “gray”.</p></li>
<li><p><strong>cmap_fft</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for the Fourier magnitude difference plot. Defaults to “hot”.</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum data value that the colormap covers for the image plots. If None,
it is set to 1.1 times the minimum value found in the images. Defaults to None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – The maximum data value that the colormap covers for the image plots. If None,
it is set to 1.1 times the maximum value found in the images. Defaults to None.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object containing the plots.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.plot_modulator_1D">
<span class="sig-name descname"><span class="pre">plot_modulator_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.plot_modulator_1D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.plot_modulator_1D" title="Link to this definition"></a></dt>
<dd><p>Plot the 1D modulation profile of the noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show the plot. Default is True.</p></li>
<li><p><strong>ax</strong> (<em>Axes</em><em>, </em><em>optional</em>) – Axes to plot on. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object if show is False, else None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.plot_modulator_2D">
<span class="sig-name descname"><span class="pre">plot_modulator_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.plot_modulator_2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.plot_modulator_2D" title="Link to this definition"></a></dt>
<dd><p>Plot the 2D modulation profile of the noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use. Default is “hot”.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to show the plot. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object if show is False, else None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.power">
<span class="sig-name descname"><span class="pre">power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.power" title="Link to this definition"></a></dt>
<dd><p>Compute the power spectrum of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>img</strong> (<em>array</em>) – The image to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>power</strong> – The power spectrum of the image.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.radial_profile">
<span class="sig-name descname"><span class="pre">radial_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">img</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.radial_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.radial_profile" title="Link to this definition"></a></dt>
<dd><p>Compute the radial profile of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img</strong> (<em>array</em>) – The 2D image to compute the radial profile for.</p></li>
<li><p><strong>stat</strong> (<em>str</em><em>, </em><em>optional</em>) – The statistic to compute. Can be ‘mean’ or ‘sum’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bin_centers</strong> (<em>array</em>) – The centers of the bins in the radial direction.</p></li>
<li><p><strong>bin_edges</strong> (<em>array</em>) – The edges of the bins in the radial direction.</p></li>
<li><p><strong>bin_means</strong> (<em>array</em>) – The mean or sum of the values in each bin, depending on the stat argument.</p></li>
<li><p><strong>bin_entries</strong> (<em>array</em>) – The number of entries in each bin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.set_apix">
<span class="sig-name descname"><span class="pre">set_apix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apix</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.set_apix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.set_apix" title="Link to this definition"></a></dt>
<dd><p>Set the resolution in Angstroms per pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>apix</strong> (<em>float</em>) – Resolution in Angstroms per pixel.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.set_flat">
<span class="sig-name descname"><span class="pre">set_flat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.set_flat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.set_flat" title="Link to this definition"></a></dt>
<dd><p>Set the noise modulation to a flat distribution.</p>
<p>The modulation is constant and set to 1.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseModulator.set_modulation">
<span class="sig-name descname"><span class="pre">set_modulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bin_edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseModulator.set_modulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseModulator.set_modulation" title="Link to this definition"></a></dt>
<dd><p>Set the noise modulation to a user-defined histogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bin_edges</strong> (<em>array</em>) – The bin edges of the histogram.</p></li>
<li><p><strong>variance</strong> (<em>array</em>) – The variance values corresponding to the bin edges.</p></li>
<li><p><strong>box_size</strong> (<em>int</em>) – The box size of the Fourier transform.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">NoiseShaper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.sampler.Sampler" title="EMCrafter.sampler.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.build_sampler">
<span class="sig-name descname"><span class="pre">build_sampler</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.build_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.build_sampler" title="Link to this definition"></a></dt>
<dd><p>Builds the sampler by computing the Probability Density Function (PDF)
and Cumulative Distribution Function (CDF) over a specified range.
The Inverse CDF is constructed for sampling purposes.</p>
<p>The sampler is built over a range of x values from -10 to 10, with a
resolution of 10000 points. The PDF is evaluated using the currently
set distribution function, normalized, and its CDF is computed. The
Inverse CDF is then created to allow for efficient sampling from the
distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.get_index">
<span class="sig-name descname"><span class="pre">get_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.get_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.get_index" title="Link to this definition"></a></dt>
<dd><p>Get the sample at the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the sample to retrieve. Defaults to 0.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sample</strong> – 2D array containing the sample at the specified index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If there are no samples stored.</p></li>
<li><p><strong>ValueError</strong> – If the index is out of range.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.plot_density">
<span class="sig-name descname"><span class="pre">plot_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.plot_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.plot_density" title="Link to this definition"></a></dt>
<dd><p>Plot a histogram of the noise sample at the specified index and the corresponding probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the sample to plot. Defaults to 0.</p></li>
<li><p><strong>bins</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of histogram bins. Defaults to 100.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib axes</em><em>, </em><em>optional</em>) – Axes to plot on. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.plot_image">
<span class="sig-name descname"><span class="pre">plot_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.plot_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.plot_image" title="Link to this definition"></a></dt>
<dd><p>Plots a 2D image of a noise sample at the specified index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the sample to plot. Defaults to 0.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for the image. Defaults to “gray”.</p></li>
<li><p><strong>vmin</strong> (<em>float</em><em>, </em><em>optional</em>) – The minimum data value that the colormap covers. Defaults to None.</p></li>
<li><p><strong>vmax</strong> (<em>float</em><em>, </em><em>optional</em>) – The maximum data value that the colormap covers. Defaults to None.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.sample" title="Link to this definition"></a></dt>
<dd><p>Sample the noise distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – Shape of the output noise samples.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of samples to generate. Defaults to 1.</p></li>
<li><p><strong>store</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, store the generated samples in the <cite>samples</cite> attribute.
Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>samples</strong> – Array of shape (n, shape[0], shape[1]) containing the generated noise samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.set_exp_mod_gaussian_shape">
<span class="sig-name descname"><span class="pre">set_exp_mod_gaussian_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.84</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.64</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.set_exp_mod_gaussian_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.set_exp_mod_gaussian_shape" title="Link to this definition"></a></dt>
<dd><p>Set the shape of the noise sampler to an Exponentially Modified Gaussian distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitude</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the Exponentially Modified Gaussian distribution. Defaults to -1.0.</p></li>
<li><p><strong>mu</strong> (<em>float</em><em>, </em><em>optional</em>) – Mean of the Gaussian distribution. Defaults to 0.6.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Standard deviation of the Gaussian distribution. Defaults to -0.84.</p></li>
<li><p><strong>lambd</strong> (<em>float</em><em>, </em><em>optional</em>) – Exponential rate of the Exponentially Modified Gaussian distribution. Defaults to -1.64.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.set_gaussian_shape">
<span class="sig-name descname"><span class="pre">set_gaussian_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.set_gaussian_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.set_gaussian_shape" title="Link to this definition"></a></dt>
<dd><p>Set the shape of the noise sampler to a Gaussian distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitude</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the Gaussian distribution. Defaults to 0.4 (~1/sqrt(2pi)).</p></li>
<li><p><strong>x0</strong> (<em>float</em><em>, </em><em>optional</em>) – Mean or center of the Gaussian distribution. Defaults to 0.0.</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>optional</em>) – Standard deviation of the Gaussian distribution. Defaults to 1.0.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.noise.NoiseShaper.set_skew_normal_shape">
<span class="sig-name descname"><span class="pre">set_skew_normal_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">amplitude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1.4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#NoiseShaper.set_skew_normal_shape"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.NoiseShaper.set_skew_normal_shape" title="Link to this definition"></a></dt>
<dd><p>Set the shape of the noise sampler to a Skew-Normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>amplitude</strong> (<em>float</em><em>, </em><em>optional</em>) – Amplitude of the Skew-Normal distribution. Defaults to 1.0.</p></li>
<li><p><strong>loc</strong> (<em>float</em><em>, </em><em>optional</em>) – Location parameter of the Skew-Normal distribution. Defaults to 0.85.</p></li>
<li><p><strong>scale</strong> (<em>float</em><em>, </em><em>optional</em>) – Scale parameter of the Skew-Normal distribution. Defaults to 1.3.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Skewness parameter of the Skew-Normal distribution. Defaults to -1.4.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EMCrafter.noise.exp_mod_gaussian">
<span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">exp_mod_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lambd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#exp_mod_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.exp_mod_gaussian" title="Link to this definition"></a></dt>
<dd><p>Calculate the Exponentially Modified Gaussian probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Input values for which to calculate the Exponentially Modified Gaussian function.</p></li>
<li><p><strong>amplitude</strong> (<em>float</em>) – Amplitude of the Exponentially Modified Gaussian function.</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – Center of the Exponentially Modified Gaussian function.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Standard deviation of the Exponentially Modified Gaussian function.</p></li>
<li><p><strong>lambd</strong> (<em>float</em>) – Exponential rate of the Exponentially Modified Gaussian function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated Exponentially Modified Gaussian function at input values x.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EMCrafter.noise.gaussian">
<span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.gaussian" title="Link to this definition"></a></dt>
<dd><p>Calculate the Gaussian probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Input values for which to calculate the Gaussian function.</p></li>
<li><p><strong>amplitude</strong> (<em>float</em>) – Amplitude of the Gaussian function.</p></li>
<li><p><strong>x0</strong> (<em>float</em>) – Mean or center of the Gaussian function.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Standard deviation of the Gaussian function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated Gaussian function at input values x.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EMCrafter.noise.skew_normal">
<span class="sig-prename descclassname"><span class="pre">EMCrafter.noise.</span></span><span class="sig-name descname"><span class="pre">skew_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amplitude</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/noise.html#skew_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.noise.skew_normal" title="Link to this definition"></a></dt>
<dd><p>Calculate the Skew-Normal probability density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – Input values for which to calculate the Skew-Normal function.</p></li>
<li><p><strong>amplitude</strong> (<em>float</em>) – Amplitude of the Skew-Normal function.</p></li>
<li><p><strong>loc</strong> (<em>float</em>) – Location parameter of the Skew-Normal function.</p></li>
<li><p><strong>scale</strong> (<em>float</em>) – Scale parameter of the Skew-Normal function.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Skewness parameter of the Skew-Normal function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Evaluated Skew-Normal function at input values x.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-EMCrafter.signal">
<span id="emcrafter-signal"></span><h2>EMCrafter.signal<a class="headerlink" href="#module-EMCrafter.signal" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.signal.</span></span><span class="sig-name descname"><span class="pre">SignalGenerator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eman_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.corrupt_n_particles">
<span class="sig-name descname"><span class="pre">corrupt_n_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.corrupt_n_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.corrupt_n_particles" title="Link to this definition"></a></dt>
<dd><p>Corrupt a set of particles by applying a contrast transfer function and normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – The path to the input file containing particle data.</p></li>
<li><p><strong>defocus</strong> (<em>array-like</em>) – A list or array of defocus values for each particle.</p></li>
<li><p><strong>store</strong> (<em>dict</em>) – A dictionary containing the path to the output file in the ‘c’ key.</p></li>
<li><p><strong>thr</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for mask generation. Default is 0.01.</p></li>
<li><p><strong>pad</strong> (<em>int</em><em>, </em><em>optional</em>) – Padding size for mask generation. Default is 15.</p></li>
<li><p><strong>norm</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to normalize the particles after processing. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The path to the output file containing the corrupted particles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.corrupt_signal">
<span class="sig-name descname"><span class="pre">corrupt_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.corrupt_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.corrupt_signal" title="Link to this definition"></a></dt>
<dd><p>Apply a CTF corruption to the signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>EMData</em><em> or </em><em>ndarray</em>) – The signal to corrupt.</p></li>
<li><p><strong>defocus</strong> (<em>float</em>) – The defocus value in Angstroms.</p></li>
<li><p><strong>store</strong> (<em>bool</em><em>, </em><em>optional</em>) – Store the corrupted signal. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – The corrupted signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>EMData or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.density_projections_core">
<span class="sig-name descname"><span class="pre">density_projections_core</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.density_projections_core"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.density_projections_core" title="Link to this definition"></a></dt>
<dd><p>Run the e2project3d.py script in the background using subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>tuple</em>) – A tuple containing the arguments for the subprocess.run call.
The tuple should contain the following elements in order:
(script_path: str, input_file: str, output_path_i: str, orientations: str, verbose: int)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The CompletedProcess object returned by subprocess.run.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>subprocess.CompletedProcess</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.em2np">
<span class="sig-name descname"><span class="pre">em2np</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.em2np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.em2np" title="Link to this definition"></a></dt>
<dd><p>Convert an EMData or EMData array to a numpy array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>EMData</em><em> or </em><em>EMData array</em>) – The object to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted numpy array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.get_error">
<span class="sig-name descname"><span class="pre">get_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.get_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.get_error" title="Link to this definition"></a></dt>
<dd><p>Return a string containing the error message of a subprocess.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output</strong> (<em>subprocess.CompletedProcess</em>) – The output of the process.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string containing the error message of the process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.load_volume">
<span class="sig-name descname"><span class="pre">load_volume</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.load_volume"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.load_volume" title="Link to this definition"></a></dt>
<dd><p>Load the volume from the given path or use the internal volume path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>volume_path</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to the volume file. Default is None, which uses the internal path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.make_mask">
<span class="sig-name descname"><span class="pre">make_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.make_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.make_mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.merge_single_files">
<span class="sig-name descname"><span class="pre">merge_single_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.merge_single_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.merge_single_files" title="Link to this definition"></a></dt>
<dd><p>Merge multiple EMData files into a single output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> (<em>list</em><em> of </em><em>str</em>) – List of file paths to the input EMData files to be merged.</p></li>
<li><p><strong>output_path</strong> (<em>str</em>) – Path to the output file where the merged data will be saved.</p></li>
<li><p><strong>clean</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, delete the original input files after merging. Default is False.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – Verbosity level for logging and progress updates. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The path to the output file containing the merged data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.normalize_signal">
<span class="sig-name descname"><span class="pre">normalize_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.normalize_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.normalize_signal" title="Link to this definition"></a></dt>
<dd><p>Normalize a signal to zero mean and unit variance using the given mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>EMData</em><em> or </em><em>ndarray</em>) – The signal to normalize.</p></li>
<li><p><strong>pmask</strong> (<em>ndarray</em>) – The binary mask to use for normalization.</p></li>
<li><p><strong>store</strong> (<em>bool</em><em>, </em><em>optional</em>) – Store the normalized signal. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – The normalized signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>EMData or ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.np2em">
<span class="sig-name descname"><span class="pre">np2em</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.np2em"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.np2em" title="Link to this definition"></a></dt>
<dd><p>Convert a numpy array to an EMData or EMData array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<em>numpy array</em>) – The object to convert.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The converted EMData or EMData array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>EMData or EMData array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.pdb2map">
<span class="sig-name descname"><span class="pre">pdb2map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stdout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.pdb2map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.pdb2map" title="Link to this definition"></a></dt>
<dd><p>Convert a PDB file into a 3D electron density map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apix</strong> (<em>float</em>) – Resolution in Angstroms per pixel.</p></li>
<li><p><strong>box</strong> (<em>int</em><em>, </em><em>optional</em>) – Size of the output box in pixels. Default is None.</p></li>
<li><p><strong>res</strong> (<em>float</em><em>, </em><em>optional</em>) – Resolution of the output map in Angstroms. Default is 2.5 times the apix value.</p></li>
<li><p><strong>center</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the map is centered. Default is True.</p></li>
<li><p><strong>stdout</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the output is printed. Default is True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pmask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the simulated signal and its intermediate states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>EMData</em><em> or </em><em>ndarray</em><em>, </em><em>optional</em>) – The simulated signal to plot. If None, uses stored data. Default is None.</p></li>
<li><p><strong>pmask</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – The binary mask to apply to the signal. Default is None.</p></li>
<li><p><strong>use_mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to apply the mask to the signal during plotting. Default is True.</p></li>
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for plotting. Default is “gray”.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to display the plot. If False, the figure is closed. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If no data is available to plot and no particle argument is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.project_signal">
<span class="sig-name descname"><span class="pre">project_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'em'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.project_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.project_signal" title="Link to this definition"></a></dt>
<dd><p>Project a volume onto a plane given Euler angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<em>EMData</em><em> or </em><em>numpy array</em>) – The volume to project.</p></li>
<li><p><strong>alt</strong> (<em>float</em>) – The altitude angle in degrees.</p></li>
<li><p><strong>az</strong> (<em>float</em>) – The azimuth angle in degrees.</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – The in-plane rotation angle in degrees.</p></li>
<li><p><strong>mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to generate a mask. Defaults to True.</p></li>
<li><p><strong>thr</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold value for the mask. Defaults to 0.5.</p></li>
<li><p><strong>pad</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of iterations of binary dilation to apply to the mask. Defaults to 20.</p></li>
<li><p><strong>store</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to store the clean signal and mask. Defaults to False.</p></li>
<li><p><strong>astype</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of the output. Options are “em” for EMData and “np” for numpy array. Defaults to “em”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the projected particle and the mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_cpus">
<span class="sig-name descname"><span class="pre">set_cpus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_cpus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_cpus" title="Link to this definition"></a></dt>
<dd><p>Set the number of CPUs to use for the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_cpus</strong> (<em>int</em>) – The number of CPUs to use. If less than 1, 1 CPU is used. If more
than the total number of cores available, the total number of cores
minus one is used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_eman_dir">
<span class="sig-name descname"><span class="pre">set_eman_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eman_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_eman_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_eman_dir" title="Link to this definition"></a></dt>
<dd><p>Set the path to the EMAN2 directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>eman_dir</strong> (<em>str</em>) – The path to the EMAN2 directory.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If the path is not a string.</p></li>
<li><p><strong>FileNotFoundError</strong> – If the specified directory does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_env">
<span class="sig-name descname"><span class="pre">set_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_env" title="Link to this definition"></a></dt>
<dd><p>Set the conda environment for the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>env</strong> (<em>str</em><em>, </em><em>optional</em>) – The path to the conda environment to be used. If not provided, the current system’s default environment is used.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If the provided environment path is not a string.</p></li>
<li><p><strong>FileNotFoundError</strong> – If the environment could not be determined or does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_force">
<span class="sig-name descname"><span class="pre">set_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_force"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_force" title="Link to this definition"></a></dt>
<dd><p>Set whether to force the simulation, even if the output files already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>force</strong> (<em>bool</em>) – If True, force the simulation, overwriting existing files if necessary.
If False, do not force and throw an error if the output files already exist.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_output">
<span class="sig-name descname"><span class="pre">set_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_output" title="Link to this definition"></a></dt>
<dd><p>Set the output directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output</strong> (<em>str</em>) – The path to the output directory.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If the path is not a string.</p></li>
<li><p><strong>FileExistsError</strong> – If the specified directory already exists, and <cite>force</cite> is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_parameters">
<span class="sig-name descname"><span class="pre">set_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">voltage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bfactor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ampcont</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_parameters" title="Link to this definition"></a></dt>
<dd><p>Set the simulation parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>apix</strong> (<em>float</em>) – Resolution in Angstroms per pixel.</p></li>
<li><p><strong>voltage</strong> (<em>float</em><em>, </em><em>optional</em>) – Voltage in kV. Default is 300.</p></li>
<li><p><strong>cs</strong> (<em>float</em><em>, </em><em>optional</em>) – Spherical aberration in mm. Default is 2.7.</p></li>
<li><p><strong>bfactor</strong> (<em>float</em><em>, </em><em>optional</em>) – Bfactor in A^2. Default is 100.</p></li>
<li><p><strong>ampcont</strong> (<em>float</em><em>, </em><em>optional</em>) – Contrast in percent. Default is 0.1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.set_pdb">
<span class="sig-name descname"><span class="pre">set_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.set_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.set_pdb" title="Link to this definition"></a></dt>
<dd><p>Set the path to the PDB file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pdb</strong> (<em>str</em>) – The path to the PDB file.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If the path is not a string.</p></li>
<li><p><strong>FileNotFoundError</strong> – If the specified file does not exist.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrupt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.simulate" title="Link to this definition"></a></dt>
<dd><p>Simulate a particle given Euler angles and a defocus value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>volume</strong> (<em>EMData</em><em> or </em><em>ndarray</em>) – The volume to project.</p></li>
<li><p><strong>alt</strong> (<em>float</em>) – The altitude angle in degrees.</p></li>
<li><p><strong>az</strong> (<em>float</em>) – The azimuth angle in degrees.</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – The in-plane rotation angle in degrees.</p></li>
<li><p><strong>defocus</strong> (<em>float</em>) – The defocus value in Angstroms.</p></li>
<li><p><strong>mask</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to generate a mask. Defaults to True.</p></li>
<li><p><strong>thr</strong> (<em>float</em><em>, </em><em>optional</em>) – The threshold value for the mask. Defaults to 0.5.</p></li>
<li><p><strong>pad</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of iterations of binary dilation to apply to the mask. Defaults to 20.</p></li>
<li><p><strong>corrupt</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to corrupt the signal with a CTF. Defaults to True.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to normalize the signal. Defaults to True.</p></li>
<li><p><strong>store</strong> (<em>bool</em><em>, </em><em>optional</em>) – Store the simulated particle, mask, and intermediate steps. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the simulated particle and the mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.simulate_n">
<span class="sig-name descname"><span class="pre">simulate_n</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.simulate_n"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.simulate_n" title="Link to this definition"></a></dt>
<dd><p>Simulate a set of particles and corrupt them by applying a contrast transfer function and normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles</strong> (<em>array-like</em>) – A 2D array of shape (n_particles, 3) containing the Euler angles.</p></li>
<li><p><strong>defocus</strong> (<em>array-like</em>) – A list or array of defocus values for each particle.</p></li>
<li><p><strong>store</strong> (<em>dict</em>) – A dictionary containing the path to the output file in the ‘p’ key.</p></li>
<li><p><strong>cpus</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of CPUs to use for simulation. Default is 1.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – The level of verbosity. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the paths to the simulated and corrupted particles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.simulate_n_projections">
<span class="sig-name descname"><span class="pre">simulate_n_projections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.simulate_n_projections"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.simulate_n_projections" title="Link to this definition"></a></dt>
<dd><p>Simulate n 2D projections from a given set of angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles</strong> (<em>numpy array</em>) – A 2D numpy array of shape (n_projections, 3) containing the Euler angles for each projection.</p></li>
<li><p><strong>store</strong> (<em>dict</em>) – A dictionary containing the path to the output file in the ‘p’ key.</p></li>
<li><p><strong>cpus</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of CPUs to use for parallel processing. Default is 1.</p></li>
<li><p><strong>verbose</strong> (<em>int</em><em>, </em><em>optional</em>) – The verbosity level for logging and progress updates. Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The path to the output file containing the simulated projections.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.simulate_single_eman">
<span class="sig-name descname"><span class="pre">simulate_single_eman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.simulate_single_eman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.simulate_single_eman" title="Link to this definition"></a></dt>
<dd><p>Run a single e2project3d.py subprocess to simulate a projection from an EMData file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>args</strong> (<em>tuple</em>) – A tuple with the following elements:
(script_path: str, input_file: str, output_path_i: str, orientations: str, verbose: int)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The CompletedProcess object returned by subprocess.run.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>subprocess.CompletedProcess</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.validate_files">
<span class="sig-name descname"><span class="pre">validate_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">files</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.validate_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.validate_files" title="Link to this definition"></a></dt>
<dd><p>Validate that the given files exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>files</strong> (<em>list</em>) – The list of files to validate</p></li>
<li><p><strong>labels</strong> (<em>list</em>) – The labels to use for each file if it does not exist</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If any of the files do not exist.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.validate_init">
<span class="sig-name descname"><span class="pre">validate_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.validate_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.validate_init" title="Link to this definition"></a></dt>
<dd><p>Validate that the necessary variables have been set before running a simulation.</p>
<p>This checks that the EMAN directory, PDB file, and output directory have been set, and that the Python executable has been set.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – If any of the necessary variables have not been set.</p></li>
<li><p><strong>FileNotFoundError</strong> – If any of the necessary variables point to a non-existent file or directory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.signal.SignalGenerator.validate_output">
<span class="sig-name descname"><span class="pre">validate_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/signal.html#SignalGenerator.validate_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.signal.SignalGenerator.validate_output" title="Link to this definition"></a></dt>
<dd><p>Validate that the process produced output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_path</strong> (<em>str</em>) – The path to the file that should have been produced by the process.</p></li>
<li><p><strong>output</strong> (<em>subprocess.CompletedProcess</em><em>, </em><em>optional</em>) – The output of the process. If this is given and the file does not exist, the error message will include the process’s output.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – If the file does not exist.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EMCrafter.sim">
<span id="emcrafter-sim"></span><h2>EMCrafter.sim<a class="headerlink" href="#module-EMCrafter.sim" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.sim.</span></span><span class="sig-name descname"><span class="pre">ParticleSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.info" title="Link to this definition"></a></dt>
<dd><p>Display plots for noise shaper, noise modulator, and SNR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plots. If False, the figure is closed. Defaults to True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The matplotlib figure object containing the plots.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.load_modulator">
<span class="sig-name descname"><span class="pre">load_modulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noise_freq.pkl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.load_modulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.load_modulator" title="Link to this definition"></a></dt>
<dd><p>Loads a saved NoiseModulator object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>optional</em>) – The file path from which the NoiseModulator object is to be loaded. Defaults to “noise_freq.pkl”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.load_shaper">
<span class="sig-name descname"><span class="pre">load_shaper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noise_shape.pkl'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.load_shaper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.load_shaper" title="Link to this definition"></a></dt>
<dd><p>Loads a saved NoiseShaper object from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>optional</em>) – The file path from which the NoiseShaper object is to be loaded. Defaults to “noise_shape.pkl”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.normalize" title="Link to this definition"></a></dt>
<dd><p>Normalize the input array to zero mean and unit variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<em>ndarray</em>) – The input array to normalize. Can be 2D or 3D.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The normalized array with zero mean and unit variance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.set_cpus">
<span class="sig-name descname"><span class="pre">set_cpus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.set_cpus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.set_cpus" title="Link to this definition"></a></dt>
<dd><p>Set the number of CPUs to be used.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_cpus</strong> (<em>int</em>) – The number of CPUs to be used. If less than 1, 1 CPU is used. If more
than the total number of cores available, the total number of cores
minus one is used.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.simulate">
<span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">az</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.simulate" title="Link to this definition"></a></dt>
<dd><p>Simulate a particle given Euler angles and a defocus value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alt</strong> (<em>float</em>) – The altitude angle in degrees.</p></li>
<li><p><strong>az</strong> (<em>float</em>) – The azimuth angle in degrees.</p></li>
<li><p><strong>phi</strong> (<em>float</em>) – The in-plane rotation angle in degrees.</p></li>
<li><p><strong>defocus</strong> (<em>float</em>) – The defocus value in Angstroms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the simulated particle and the mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.ParticleSimulator.simulate_dataset">
<span class="sig-name descname"><span class="pre">simulate_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cpus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'particles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intermediates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_eman</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#ParticleSimulator.simulate_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.ParticleSimulator.simulate_dataset" title="Link to this definition"></a></dt>
<dd><p>Simulate a set of particles and store the results on disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles</strong> (<em>array</em>) – A 2D array of shape (n_particles, 3) containing the Euler angles.</p></li>
<li><p><strong>defocus</strong> (<em>array</em>) – A 1D array of shape (n_particles,) containing the defocus values.</p></li>
<li><p><strong>n_cpus</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of CPUs to use for simulation. Defaults to 1.</p></li>
<li><p><strong>chunk_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of particles to simulate per chunk. Defaults to 5.</p></li>
<li><p><strong>quick</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, simulate quickly by vectorizing projection and corruption steps. Defaults to False.</p></li>
<li><p><strong>output</strong> (<em>str</em><em>, </em><em>optional</em>) – The directory where to store the simulated particles. Defaults to “particles”.</p></li>
<li><p><strong>intermediates</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to store intermediate results (clean and corrupted signals). Defaults to True.</p></li>
<li><p><strong>use_eman</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use EMAN2 framework to simulate project the density. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SimResults object containing the simulated particles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#EMCrafter.sim.SimResults" title="EMCrafter.sim.SimResults">SimResults</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.sim.</span></span><span class="sig-name descname"><span class="pre">SimResults</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'memory'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.append">
<span class="sig-name descname"><span class="pre">append</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrupted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.append"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.append" title="Link to this definition"></a></dt>
<dd><p>Append a particle to the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<em>float</em>) – The angle of the particle.</p></li>
<li><p><strong>defocus</strong> (<em>float</em>) – The defocus of the particle.</p></li>
<li><p><strong>snr</strong> (<em>float</em>) – The SNR of the particle.</p></li>
<li><p><strong>signal</strong> (<em>numpy.ndarray</em>) – The clean signal of the particle.</p></li>
<li><p><strong>corrupted</strong> (<em>numpy.ndarray</em>) – The corrupted signal of the particle.</p></li>
<li><p><strong>noisy</strong> (<em>numpy.ndarray</em>) – The noisy signal of the particle.</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the particle. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.append_array">
<span class="sig-name descname"><span class="pre">append_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defocus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corrupted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.append_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.append_array" title="Link to this definition"></a></dt>
<dd><p>Append a set of particles to the results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angles</strong> (<em>list</em><em> of </em><em>float</em>) – The angles of the particles.</p></li>
<li><p><strong>defocus</strong> (<em>list</em><em> of </em><em>float</em>) – The defocus of the particles.</p></li>
<li><p><strong>snr</strong> (<em>list</em><em> of </em><em>float</em>) – The SNR of the particles.</p></li>
<li><p><strong>signal</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – The clean signal of the particles.</p></li>
<li><p><strong>corrupted</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – The corrupted signal of the particles.</p></li>
<li><p><strong>noisy</strong> (<em>list</em><em> of </em><em>numpy.ndarray</em>) – The noisy signal of the particles.</p></li>
<li><p><strong>index</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – The index of the particles. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.export_particles">
<span class="sig-name descname"><span class="pre">export_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'link'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noisy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mrcs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuflle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.export_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.export_particles" title="Link to this definition"></a></dt>
<dd><p>Export the particles to a Relion project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> (<em>str</em>) – Output folder containing the relion project structure.</p></li>
<li><p><strong>export_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of file building. Needs to be one of [“copy”, “move”, “link”].
Defaults to “link”.</p></li>
<li><p><strong>export_which</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of particles to export. Needs to be one of [“clean”, “corrupted”, “noisy”].
Defaults to “noisy”.</p></li>
<li><p><strong>extension</strong> (<em>str</em><em>, </em><em>optional</em>) – The extension of the particle files. Defaults to “mrcs”.</p></li>
<li><p><strong>shuflle</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to shuffle the particles before exporting. Defaults to False.</p></li>
<li><p><strong>force</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, force the file creation, overwriting existing files if necessary.
Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data frame related to the star file built.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.merge">
<span class="sig-name descname"><span class="pre">merge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.merge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.merge" title="Link to this definition"></a></dt>
<dd><p>Merge results from multiple simulations into one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>results</strong> (<em>list</em>) – List of files to load and merge.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The merged simulations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#EMCrafter.sim.SimResults" title="EMCrafter.sim.SimResults">SimResults</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gray'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the particles in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cmap</strong> (<em>str</em><em>, </em><em>optional</em>) – The colormap to use for the images. Defaults to “gray”.</p></li>
<li><p><strong>ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – The ids of the particles to plot. Defaults to None.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays the plot. If False, the figure is closed. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fig</strong> – The figure object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.figure.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.set_box_size">
<span class="sig-name descname"><span class="pre">set_box_size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.set_box_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.set_box_size" title="Link to this definition"></a></dt>
<dd><p>Set the box size of the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>box_size</strong> (<em>int</em>) – Box size of the particles.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.set_parameters">
<span class="sig-name descname"><span class="pre">set_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.set_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.set_parameters" title="Link to this definition"></a></dt>
<dd><p>Set the parameters of the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>parameters</strong> (<em>dict</em>) – Simulation parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.set_particle_number">
<span class="sig-name descname"><span class="pre">set_particle_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.set_particle_number"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.set_particle_number" title="Link to this definition"></a></dt>
<dd><p>Set the number of particles in the simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<em>int</em>) – Number of particles to simulate.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.set_plot_ids">
<span class="sig-name descname"><span class="pre">set_plot_ids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.set_plot_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.set_plot_ids" title="Link to this definition"></a></dt>
<dd><p>Set the particle IDs to be plotted in the show method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ids</strong> (<em>list</em><em> or </em><em>array</em>) – The IDs of the particles to be plotted. If the length is larger than MAX_PLOT,
only the first MAX_PLOT IDs will be used.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.set_random_ids">
<span class="sig-name descname"><span class="pre">set_random_ids</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.set_random_ids"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.set_random_ids" title="Link to this definition"></a></dt>
<dd><p>Set the particle IDs to be plotted in the show method to a random subset.
The length of the subset is MAX_PLOT. If the length of the particles is
smaller than MAX_PLOT, all particles will be used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.sim.SimResults.set_type">
<span class="sig-name descname"><span class="pre">set_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/sim.html#SimResults.set_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.sim.SimResults.set_type" title="Link to this definition"></a></dt>
<dd><p>Set the type of simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>t</strong> (<em>str</em>) – Type of simulation. Either “memory” (default) or “disk” (written).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EMCrafter.rln">
<span id="emcrafter-rln"></span><h2>EMCrafter.rln<a class="headerlink" href="#module-EMCrafter.rln" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.rln.</span></span><span class="sig-name descname"><span class="pre">Exporter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.build_output">
<span class="sig-name descname"><span class="pre">build_output</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.build_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.build_output" title="Link to this definition"></a></dt>
<dd><p>Build the output directory by creating the necessary subdirectories and files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.build_particles">
<span class="sig-name descname"><span class="pre">build_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.build_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.build_particles" title="Link to this definition"></a></dt>
<dd><p>Build physical files for the particles in the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – The data frame containing the particles information.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – The number of particles in the data.</p></li>
<li><p><strong>export_type</strong> (<em>str</em>) – The type of file building: “link”, “move”, or “copy”.</p></li>
<li><p><strong>export_which</strong> (<em>str</em>) – The column name in the data frame indicating which files to export.</p></li>
<li><p><strong>extension</strong> (<em>str</em>) – The file extension to use for the exported files.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – If True, force the file creation, overwriting existing files if necessary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data frame with the locations of the exported files.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'link'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.copy" title="Link to this definition"></a></dt>
<dd><p>Copy, move, or link a file from the source to the destination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>str</em>) – The path to the source file.</p></li>
<li><p><strong>destination</strong> (<em>str</em>) – The path to the destination file.</p></li>
<li><p><strong>copy_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of operation to perform: “link” (default), “move”, or “copy”.</p></li>
<li><p><strong>force</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, force the operation, overwriting existing files if necessary. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>subprocess.CalledProcessError</strong> – If the command execution fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.create_fake_micrograph">
<span class="sig-name descname"><span class="pre">create_fake_micrograph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.create_fake_micrograph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.create_fake_micrograph" title="Link to this definition"></a></dt>
<dd><p>Create an empty file at the specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – The path to create the empty file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'link'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noisy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mrcs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuflle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.export" title="Link to this definition"></a></dt>
<dd><p>Export particles to a relion project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> (<em>list</em>) – The list of particles to export.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em>) – The simulation parameters.</p></li>
<li><p><strong>box_size</strong> (<em>int</em>) – The box size of the particles.</p></li>
<li><p><strong>export_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of export to perform. Options are “copy”, “move” or “link”.
Defaults to “link”.</p></li>
<li><p><strong>export_which</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of particles to export. Options are “noisy” or “clean”.
Defaults to “noisy”.</p></li>
<li><p><strong>extension</strong> (<em>str</em><em>, </em><em>optional</em>) – The extension of the particle files. Defaults to “mrcs”.</p></li>
<li><p><strong>shuflle</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to shuffle the particles before exporting. Defaults to False.</p></li>
<li><p><strong>force</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to override the existing files. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data frame with the set attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.format_optics">
<span class="sig-name descname"><span class="pre">format_optics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.format_optics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.format_optics" title="Link to this definition"></a></dt>
<dd><p>Format the optics data for a relion project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>dict</em>) – The simulation parameters.</p></li>
<li><p><strong>box_size</strong> (<em>int</em>) – The box size of the particles.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>optics</strong> – The formatted optics data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.format_particles">
<span class="sig-name descname"><span class="pre">format_particles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_which</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.format_particles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.format_particles" title="Link to this definition"></a></dt>
<dd><p>Format the particle data for export to a relion project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> (<em>list</em>) – The list of particle dictionaries to format.</p></li>
<li><p><strong>export_which</strong> (<em>str</em>) – The key indicating which type of particle data to export.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>data</strong> (<em>defaultdict(list)</em>) – The formatted particle data with keys from the original particle items.</p></li>
<li><p><strong>n_particles</strong> (<em>int</em>) – The number of particles.</p></li>
<li><p><strong>original_keys</strong> (<em>list</em>) – The list of keys that were retained in the formatted data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.set_output_dir">
<span class="sig-name descname"><span class="pre">set_output_dir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.set_output_dir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.set_output_dir" title="Link to this definition"></a></dt>
<dd><p>Set the output directory for the relion project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>output_dir</strong> (<em>str</em>) – Directory where the relion project will be exported.
If the directory already exists, existing files may be overwritten.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.set_particles_attributes">
<span class="sig-name descname"><span class="pre">set_particles_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.set_particles_attributes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.set_particles_attributes" title="Link to this definition"></a></dt>
<dd><p>Set attributes for the particles in the given data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em><em> of </em><em>dict</em>) – The data containing the particles information.</p></li>
<li><p><strong>original_keys</strong> (<em>list</em>) – The column names in the original data.</p></li>
<li><p><strong>which</strong> (<em>str</em>) – The particle type: “noisy” or “clean”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The data frame with the set attributes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.validate_export">
<span class="sig-name descname"><span class="pre">validate_export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'link'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">export_which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'noisy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mrcs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuflle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.validate_export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.validate_export" title="Link to this definition"></a></dt>
<dd><p>Validate the arguments for exporting particles to a relion project.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> (<em>list</em>) – The list of particles to export.</p></li>
<li><p><strong>parameters</strong> (<em>dict</em>) – The simulation parameters.</p></li>
<li><p><strong>box_size</strong> (<em>int</em>) – The box size of the particles.</p></li>
<li><p><strong>export_type</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of export to perform. Options are “copy”, “move” or “link”.
Defaults to “link”.</p></li>
<li><p><strong>export_which</strong> (<em>str</em><em>, </em><em>optional</em>) – The type of particles to export. Options are “noisy” or “dose_weighted”.
Defaults to “noisy”.</p></li>
<li><p><strong>extension</strong> (<em>str</em><em>, </em><em>optional</em>) – The extension of the particle files. Defaults to “mrcs”.</p></li>
<li><p><strong>shuflle</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to shuffle the particles before exporting. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>p</strong> – The validated and shuffled (if needed) list of particles.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If any of the arguments are of the wrong type.</p></li>
<li><p><strong>ValueError</strong> – If the list of particles is empty or if a required parameter is missing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.Exporter.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">particles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#Exporter.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.Exporter.write" title="Link to this definition"></a></dt>
<dd><p>Write a STAR file with the given particles and optics data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> (<em>pd.DataFrame</em>) – The particles data frame.</p></li>
<li><p><strong>optics</strong> (<em>pd.DataFrame</em>) – The optics data frame.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">EMCrafter.rln.</span></span><span class="sig-name descname"><span class="pre">rlnParticles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#EMCrafter.base.Base" title="EMCrafter.base.Base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Base</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles.get" title="Link to this definition"></a></dt>
<dd><p>Retrieve the particle and optics data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing two pandas.DataFrames:
- The first DataFrame contains the particle data.
- The second DataFrame contains the optics data.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles.load_images">
<span class="sig-name descname"><span class="pre">load_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles.load_images"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles.load_images" title="Link to this definition"></a></dt>
<dd><p>Loads the particle images from the STAR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base</strong> (<em>str</em>) – The base folder containing the particle images.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of images to load. If None, all images are loaded.
Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles.read" title="Link to this definition"></a></dt>
<dd><p>Reads a STAR file and sets the data and optics attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em>) – The path to the STAR file containing the particle data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles.set_base_folder">
<span class="sig-name descname"><span class="pre">set_base_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles.set_base_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles.set_base_folder" title="Link to this definition"></a></dt>
<dd><p>Set the base folder for reading micrograph and particle files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>base</strong> (<em>str</em>) – The base folder containing the micrograph and particle files.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles.set_data">
<span class="sig-name descname"><span class="pre">set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles.set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles.set_data" title="Link to this definition"></a></dt>
<dd><p>Set the particle and optics data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – The particle data.</p></li>
<li><p><strong>optics</strong> (<em>pandas.DataFrame</em>) – The optics data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="EMCrafter.rln.rlnParticles.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">att</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/rln.html#rlnParticles.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.rln.rlnParticles.write" title="Link to this definition"></a></dt>
<dd><p>Writes the particle and optics data to a STAR file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – The path to the output STAR file.</p></li>
<li><p><strong>att</strong> (<em>str</em><em>, </em><em>optional</em>) – The attribute to use for selecting particles. If None, all particles are used.
Defaults to None.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of particles to write. If None, all particles are written.
Defaults to None.</p></li>
<li><p><strong>ids</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – The indices of the particles to write. If None, all particles are written.
Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-EMCrafter.utils">
<span id="emcrafter-utils"></span><h2>EMCrafter.utils<a class="headerlink" href="#module-EMCrafter.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="EMCrafter.utils.circular_mask">
<span class="sig-prename descclassname"><span class="pre">EMCrafter.utils.</span></span><span class="sig-name descname"><span class="pre">circular_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soft</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/utils.html#circular_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.utils.circular_mask" title="Link to this definition"></a></dt>
<dd><p>Creates a circular mask centered at ‘center’ (default: center of image)
with a hard edge at ‘radius’. If ‘soft’ is specified, the mask is softened
over a distance of ‘soft’ pixels from the edge using a gaussian filter.</p>
<p>Returns two masks: an inner mask, and an outer mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em><em> of </em><em>int</em>) – Shape of the mask to be created.</p></li>
<li><p><strong>radius</strong> (<em>int</em><em>, </em><em>optional</em>) – Radius of the mask. Default is 80.</p></li>
<li><p><strong>soft</strong> (<em>int</em><em>, </em><em>optional</em>) – Distance over which the soft edge is applied. Default is 10.</p></li>
<li><p><strong>center</strong> (<em>tuple</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – Center of the mask. Default is the center of the image.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>inner_mask, outer_mask</strong> – The inner and outer masks, respectively.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>2D arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="EMCrafter.utils.time_format">
<span class="sig-prename descclassname"><span class="pre">EMCrafter.utils.</span></span><span class="sig-name descname"><span class="pre">time_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/EMCrafter/utils.html#time_format"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#EMCrafter.utils.time_format" title="Link to this definition"></a></dt>
<dd><p>Format a time difference from start_time to end_time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_time</strong> (<em>float</em>) – The start time of the time difference.</p></li>
<li><p><strong>end_time</strong> (<em>float</em>) – The end time of the time difference.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string representation of the time difference</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="EMCrafter documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hermann Degenhardt.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>